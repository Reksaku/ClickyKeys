<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:tb="http://www.hardcodet.net/taskbar"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:local="clr-namespace:ClickyKeys"
    x:Class="ClickyKeys.MainWindow"
    Title="ClickyKeys" 
    Width="Auto" Height="Auto" SizeToContent="WidthAndHeight"
    ResizeMode="NoResize"
    Closing="Window_Closed"
    Icon="/Resources/Icon.ico">



    <Window.Resources>
        <tb:TaskbarIcon x:Key="NotifyIcon"
                        IconSource="/Resources/Icon.ico"
                        ToolTipText="ClickyKeys">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Show" />
                    <MenuItem Header="Settings" Click="Settings_Click"/>
                    <Separator/>
                    <MenuItem Header="Exit" Click="Exit_Click"/>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>

        <Style TargetType="ToolBar">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToolBar">
                        <Border Padding="2">
                            <ToolBarPanel IsItemsHost="True"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>



    <Window.Style>
        <StaticResource ResourceKey="MaterialDesignWindow"/>
    </Window.Style>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="305*"/>
            <ColumnDefinition Width="177*"/>
        </Grid.ColumnDefinitions>
        <DockPanel LastChildFill="True" Background="{Binding Background}" Grid.ColumnSpan="2">
            <ToolBar DockPanel.Dock="Top" Height="52" x:Name="ToolStrip">
                <Button Click="Settings_Click" Content="Settings" x:Name="Settings_Button"/>
                <Button Click="TransparentMode_Click" Content="Transparent mode"/>
                <Button Click="ToggleToolbar_Click" Content="Hide toolbar (F11)"/>
                <Button Click="Reset_Click" Content="Reset (F12)"/>
                <Button Click="Info_Click" Content="Info"/>
            </ToolBar>

            <Grid x:Name="myGrid">
                <Grid.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform/>
                        <SkewTransform/>
                        <RotateTransform/>
                        <TranslateTransform/>
                    </TransformGroup>
                </Grid.RenderTransform>

                <Grid.RowDefinitions>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="100"/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
            </Grid>

            <Popup x:Name="MyPopup"
               Placement="Center"
               PlacementTarget="{Binding ElementName=myGrid}"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade">
                <Border x:Name="PopupBorder" Background="White" Padding="20" CornerRadius="8">
                    <StackPanel Width="250">
                        <TextBlock Text="New version of ClickyKeys is available."
                               FontSize="14"
                               HorizontalAlignment="Center"
                               Margin="0 0 0 10"/>

                        <Button Content="Open download page"
                            Padding="5"
                            Click="OpenLink_Click"
                            Margin="0 5 0 0"/>

                        <Button Content="Remind me next time"
                            Padding="5"
                            Click="ClosePopup_Click"
                            Margin="0 5 0 0"/>
                    </StackPanel>
                </Border>
            </Popup>
        </DockPanel>

        <Grid x:Name="TutorialOverlay"
              Background="#80000000"
              Visibility="Collapsed"
              Panel.ZIndex="100" Grid.ColumnSpan="2">

            <Border x:Name="PanelBox"
                Width="10"
                Height="10"
                Background="Transparent"
                BorderBrush="Transparent"
                BorderThickness="3"
                CornerRadius="5"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="0,0,0,0"
                Visibility="Hidden"
                IsHitTestVisible="False"    >
                <Grid x:Name="PanelBoxGrid"/>
            </Border>

            <Border x:Name="PanelBoxGlow"
                Width="10"
                Height="10"
                Background="Transparent"
                BorderBrush="#00DCDCDC"  
                BorderThickness="3"
                CornerRadius="5"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="0,0,0,0"
                Visibility="Hidden">
                <Border.Effect>
                    <BlurEffect Radius="6"/>
                </Border.Effect>

                <Border.Triggers>
                    <EventTrigger RoutedEvent="Loaded">
                        <BeginStoryboard>
                            <Storyboard RepeatBehavior="Forever" AutoReverse="True">
                                <ColorAnimation Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)"
                                    From="#00ACACAC"
                                    To="#FAACACAC"
                                    Duration="0:0:0.7" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Border.Triggers>
            </Border>



            <Border HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Padding="20"
                    CornerRadius="8"
                    Background="White">
                <StackPanel Width="300">
                    <TextBlock x:Name="TutorialText"
                               Text="Placeholder text"
                               TextWrapping="Wrap"
                               Margin="0 0 0 10"
                               />

                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right">
                        <Button Content="Skip" Margin="0 0 10 0"
                                Click="SkipTutorial_Click"/>
                        <Button Content="Next" Click="NextTutorial_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

    </Grid>
</Window>
